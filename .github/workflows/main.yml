name: AI Code Analysis

on: [push, pull_request]

jobs:
  analyze:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 2
          
      - name: Run Analysis
        run: |
          docker run --rm \
              -v "$GITHUB_WORKSPACE:/data" \
              -w /data \
              registry.cn-hangzhou.aliyuncs.com/hewenfei/ai-analy-stats:latest \
              sh -c "git config --global --add safe.directory /data && /app/entrypoint.sh"
